{% extends 'core/base.html' %}

{% block title %}Redimensiona - Generador de Miniaturas{% endblock %}

{% block content %}
<div class="hero text-center mt-2 mb-2">
    <h1 class="brand-title">Redimensiona</h1>
    <h2>Reduce el tama√±o de tus im√°genes al instante</h2>
    <p class="subtitle">3 im√°genes reducidas sin registro ‚Ä¢ Proceso instant√°neo ‚Ä¢ 100% gratis</p>
    <p class="hero-cta">¬øNecesitas m√°s? Reg√≠strate y reduce im√°genes de hasta 20MB sin l√≠mites ‚ú®</p>
</div>

<div class="upload-section">
    <h2 class="text-center">Comienza ahora</h2>
    
    <form method="post" action="{% url 'images:upload' %}" enctype="multipart/form-data">
        {% csrf_token %}
        
        {% for field in form %}
        <div class="form-group">
            {{ field.label_tag }}
            {{ field }}
            
            {% if field.name == 'original_image' %}
            <!-- Div para mostrar la vista previa de la imagen antes de subirla -->
            <div id="image-preview" class="mt-2"></div>
            {% endif %}
            
            {% if field.errors %}
            <div class="error">
                {% for error in field.errors %}
                <span>{{ error }}</span>
                {% endfor %}
            </div>
            {% endif %}
            
            {% if field.help_text %}
            <small class="help-text">{{ field.help_text }}</small>
            {% endif %}
        </div>
        {% endfor %}
        
        <button type="submit">Reducir im√°genes</button>
    </form>
</div>

<div class="features mt-2">
    <h3 class="text-center mb-2">Elige tu plan (¬°Ambos gratis!)</h3>
    <ul>
        <li>
            <strong>Sin Registro üéÅ</strong>
            <p>‚Ä¢ 3 im√°genes reducidas<br>
               ‚Ä¢ Hasta 2MB por imagen<br>
               ‚Ä¢ Proceso instant√°neo<br>
               ‚Ä¢ Sin necesidad de cuenta</p>
        </li>
        <li>
            <strong>Con Registro ‚≠ê</strong>
            <p>‚Ä¢ Im√°genes reducidas sin l√≠mite<br>
               ‚Ä¢ Hasta 20MB por imagen<br>
               ‚Ä¢ Acceso permanente<br>
               ‚Ä¢ Historial de im√°genes</p>
        </li>
        <li>
            <strong>Caracter√≠sticas üéØ</strong>
            <p>‚Ä¢ Varios tama√±os por imagen<br>
               ‚Ä¢ Elige las dimensiones<br>
               ‚Ä¢ Mantiene la calidad<br>
               ‚Ä¢ Proceso automatizado</p>
        </li>
    </ul>
</div>

<div class="cta-section text-center mt-2">
    <h3>¬øPor qu√© registrarse?</h3>
    <p>M√°s capacidad, sin l√≠mites de uso y siempre gratis. ¬°Crea tu cuenta en segundos!</p>
    <a href="{% url 'users:register' %}" class="btn-primary">Crear cuenta gratuita</a>
</div>

<script>
    // Cuando el documento est√© listo
    document.addEventListener('DOMContentLoaded', function() {
        // Obtener el input de la imagen
        const inputImagen = document.querySelector('input[type="file"]');
        // Obtener el div de vista previa
        const previewDiv = document.querySelector('#image-preview');

        // Cuando se seleccione una imagen
        inputImagen.addEventListener('change', function() {
            const archivo = this.files[0];
            if (archivo) {
                const reader = new FileReader();
                
                // Mostrar la imagen cuando se cargue
                reader.onload = function(e) {
                    previewDiv.innerHTML = `
                        <div style="position: relative;">
                            <img src="${e.target.result}" 
                                 style="max-width: 300px; 
                                        border-radius: 8px; 
                                        margin-top: 10px; 
                                        box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                            <button type="button" 
                                    onclick="limpiarSeleccion()"
                                    style="position: absolute; 
                                           top: 15px; 
                                           right: 5px; 
                                           background: #ff4444; 
                                           color: white; 
                                           border: none; 
                                           border-radius: 50%; 
                                           width: 25px; 
                                           height: 25px; 
                                           cursor: pointer;">√ó</button>
                        </div>
                    `;
                }
                
                reader.readAsDataURL(archivo);
            } else {
                // Si no hay archivo seleccionado, limpiar la vista previa
                previewDiv.innerHTML = '';
            }
        });
    });

    // Funci√≥n para limpiar la selecci√≥n
    function limpiarSeleccion() {
        const inputImagen = document.querySelector('input[type="file"]');
        const previewDiv = document.querySelector('#image-preview');
        inputImagen.value = ''; // Limpia el input
        previewDiv.innerHTML = ''; // Limpia la vista previa
    }
</script>
{% endblock %}